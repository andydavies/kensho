<!DOCTYPE html>
<html>
<head>
	
</head>
<body>
	<h1>JS Test</h1>
	<h2>js 1</h2>
	<div>
		JS loaded from normal script tag
	</div>
	<div id="js1loaded"></div>
	<h2>js 2</h2>
	<div>
		JS loaded from script tag generated by document.write()
	</div>
	<div id="js2loaded"></div>
	<h2>js 3</h2>
	<div>
		JS loaded from script tag generated dynamic DOM creation with src already set
	</div>
	<div id="js3loaded"></div>
	<h2>js 4</h2>
	<div>
		JS loaded from script tag generated dynamic DOM creation with src set after the node was inserted
	</div>
	<div id="js4loaded"></div>
	<h2>js 5</h2>
	<div>
		JS loaded from script tag in iframe
	</div>
	<div id="js5loaded"></div>
	<h2>js 6</h2>
	<div>
		JS loaded XHR eval
	</div>
	<div id="js6loaded"></div>
	<h2>js 7</h2>
	<div>
		JS loaded XHR injection
	</div>
	<div id="js7loaded"></div>

	<script src="js1.js"></script>
	<script>
	document.write('<script src="js2.js"><\/script>');
	</script>
	<script>

	var first_js = document.getElementsByTagName('script')[0];
	var js3 = document.createElement('script');
	js3.src = 'js3.js';
	first_js.parentNode.insertBefore(js3, first_js);

	var js4 = document.createElement('script');
	first_js.parentNode.insertBefore(js4, first_js);
	js4.src = 'js4.js';

	</script>
	<iframe width="0" height="0" style="display:none" src="jsframe.html" ></iframe>
	<script>


	var xmlhttp6 = new XMLHttpRequest();
    xmlhttp6.open("GET", 'js6.js');
    xmlhttp6.onreadystatechange = function()
    {
        if ((xmlhttp6.status == 200) && (xmlhttp6.readyState == 4))
        {
            eval(xmlhttp6.responseText);
        }
    };
    xmlhttp6.send();

    var xmlhttp7 = new XMLHttpRequest();
    xmlhttp7.open("GET", 'js7.js');
    xmlhttp7.onreadystatechange = function()
    {
        if ((xmlhttp7.status == 200) && (xmlhttp7.readyState == 4))
        {
        	var js7 = document.createElement('script');
			js7.text = xmlhttp7.responseText;
			first_js.parentNode.insertBefore(js7, first_js);
        }
    };
    xmlhttp7.send();


	var expectedTestResults = {
		"/js1.js": {
			message: "loading js via normal script tag in html",
			expected: {type: "parser",
						url: "/test_js.html",
						lineNumber: 44}
					},
		"/js2.js": {
			message: "loading js via document.write in html",
			expected: {
				type: "script",
				stackTrace: [{
					url: "/test_js.html",
					lineNumber: 46}]
				}
				},
		"/js3.js": {
			message: "loading js via dynamic created script node ",
			expected: {
				type: "script",
				stackTrace: [{
					url: "/test_js.html",
					lineNumber: 53}]
				}
				}
				,
		"/js4.js": {
			message: "loading js via dynamic created script node setting src after creation",
			expected: {
				type: "script",
				stackTrace: [{
					url: "/test_js.html",
					lineNumber: 57}]
				}
				},
		"/js5.js": {
			message: "loading js via dynamic created script node setting src after creation",
			expected: {type: "parser",
						url: "/jsframe.html",
						lineNumber: 4}
					},
		"/js6.js": {
			message: "loading js via XHR eval",
			expected: {
				type: "script",
				stackTrace: [{
					url: "/test_js.html",
					lineNumber: 73}]
				}
				},
		"/js7.js": {
			message: "loading js via XHR srcipt text injection",
			expected: {
				type: "script",
				stackTrace: [{
					url: "/test_js.html",
					lineNumber: 86}]
				}
				}
				
			};
	</script>
</body>
</html>